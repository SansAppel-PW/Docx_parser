# DOCX解析器项目结构说明

## 📁 目录结构

```
Docx_parser-main/
├── 📄 docx_parser.py           # 主解析程序
├── 📄 quick_parse_example.py   # 快速解析示例
├── 📄 test_quick_mode.py       # 性能测试脚本
├── 📄 test_optimized_parser.py # 优化验证脚本
├── 📄 README.md                # 项目说明
├── 📄 优化说明.md              # 代码优化文档
├── 📄 速度优化说明.md          # 性能优化文档
├── 📄 项目结构说明.md          # 本文档
├── 📄 organize_project.py      # 项目整理脚本
├── 📄 docx_parser.log          # 运行日志
│
├── 📁 Files/                   # 原始文档存储目录
│   ├── 📁 PLM2.0/             # PLM 2.0 相关文档
│   │   ├── 📄 BOM 审核申请.docx
│   │   ├── 📄 CBB新建申请V2.0.docx
│   │   ├── 📄 新ECR.docx
│   │   └── ...                # 其他Word文档
│   └── 📁 其他项目/           # 其他项目文档
│
├── 📁 parsed_docs/            # 解析结果存储目录
│   ├── 📁 PLM2.0_parsed/     # PLM2.0文档解析结果
│   │   ├── 📄 summary.json    # 批量处理汇总信息
│   │   ├── 📁 BOM审核申请/     # 单个文档解析结果
│   │   │   ├── 📄 document.json      # 结构化文档数据
│   │   │   ├── 📁 images/            # 提取的图片
│   │   │   ├── 📁 smartart/          # SmartArt数据
│   │   │   └── 📁 embedded_objects/  # 嵌入对象
│   │   └── 📁 其他文档/
│   │
│   └── 📁 single_files/      # 单个文件解析结果
│       └── 📁 文档名/
│           ├── 📄 document.json
│           ├── 📁 images/
│           ├── 📁 smartart/
│           └── 📁 embedded_objects/
│
├── 📁 Test/                   # 测试和开发工具
│   ├── 📄 analyze_*.py       # 各种分析脚本
│   ├── 📄 test_*.py          # 测试脚本
│   └── 📄 SmartArt解析总结报告.md
│
└── 📁 __pycache__/           # Python缓存文件
```

## 🚀 使用方式

### 1. 批量处理文件夹
```bash
# 处理整个PLM2.0文件夹
python docx_parser.py Files/PLM2.0

# 结果将保存在 parsed_docs/PLM2.0_parsed/ 目录下
```

### 2. 处理单个文件
```bash
# 处理单个DOCX文件
python docx_parser.py Files/PLM2.0/BOM审核申请.docx

# 结果将保存在 parsed_docs/single_files/BOM审核申请/ 目录下
```

### 3. 快速测试
```bash
# 运行快速解析示例
python quick_parse_example.py

# 运行性能测试
python test_quick_mode.py
```

## 📊 解析结果结构

### document.json 结构
```json
{
  "metadata": {
    "source_path": "原始文件路径",
    "title": "文档标题",
    "author": "作者",
    "created": "创建时间",
    "modified": "修改时间",
    "file_size": "文件大小"
  },
  "sections": [
    {
      "type": "section",
      "title": "章节标题",
      "level": 1,
      "content": [
        {
          "type": "paragraph",
          "text": "段落内容"
        },
        {
          "type": "list_item",
          "text": "列表项内容",
          "prefix": "1. ",
          "level": 0
        },
        {
          "type": "image",
          "url": "images/img_xxx.jpg",
          "width": 800,
          "height": 600
        },
        {
          "type": "smartart",
          "text_content": ["节点1", "节点2"],
          "diagram_type": "process"
        },
        {
          "type": "embedded_object",
          "object_type": "visio_diagram",
          "description": "Visio绘图/流程图"
        }
      ]
    }
  ],
  "images": {
    "img_xxx": {
      "type": "image",
      "url": "images/img_xxx.jpg",
      "format": "jpg",
      "width": 800,
      "height": 600,
      "size": "125.3 KB"
    }
  },
  "processing_info": {
    "timestamp": "处理时间",
    "blocks_processed": 150,
    "images_found": 16,
    "errors": [],
    "warnings": []
  }
}
```

## 🔧 目录管理

### 自动目录创建
- 程序会自动创建必要的输出目录
- 输出目录基于输入文件/文件夹名称生成
- 避免覆盖已有结果

### 目录命名规则
- **批量处理**: `parsed_docs/{文件夹名}_parsed/`
- **单文件处理**: `parsed_docs/single_files/{文件名}/`
- **安全文件名**: 自动移除特殊字符，限制长度

### 内容分类存储
- **document.json**: 主要的结构化数据
- **images/**: 所有提取的图片文件
- **smartart/**: SmartArt图表的JSON数据
- **embedded_objects/**: 嵌入对象的JSON数据和预览图

## 📈 处理统计

### summary.json（批量处理时生成）
```json
{
  "input_folder": "Files/PLM2.0",
  "processing_timestamp": "2025-08-07 15:30:00",
  "total_files": 45,
  "processed": 42,
  "failed": 3,
  "success_rate": "93.3%",
  "documents": [
    {
      "file": "BOM审核申请.docx",
      "status": "success",
      "images_found": 16,
      "warnings": 0,
      "errors": 0
    }
  ],
  "failed_files": []
}
```

## 🛠️ 维护建议

### 1. 定期清理
- 删除不需要的解析结果
- 清理临时文件和日志

### 2. 备份重要结果
- 重要的解析结果应该备份
- 考虑版本管理

### 3. 监控空间使用
- 图片文件可能占用较大空间
- 定期检查磁盘使用情况

## 🚨 注意事项

1. **输入目录**: 请将Word文档放在 `Files/` 目录下
2. **输出目录**: 解析结果统一保存在 `parsed_docs/` 目录下
3. **日志文件**: 运行日志保存为 `docx_parser.log`
4. **快速模式**: 默认启用，跳过耗时的图像转换
5. **错误处理**: 处理失败的文件会在summary.json中记录

## 📞 支持信息

- 查看日志文件了解详细的处理过程
- 使用测试脚本验证功能
- 参考优化说明文档了解性能改进
