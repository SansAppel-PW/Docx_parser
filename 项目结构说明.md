# DOCXè§£æå™¨é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
Docx_parser-main/
â”œâ”€â”€ ğŸ“„ docx_parser.py           # ä¸»è§£æç¨‹åº
â”œâ”€â”€ ğŸ“„ quick_parse_example.py   # å¿«é€Ÿè§£æç¤ºä¾‹
â”œâ”€â”€ ğŸ“„ test_quick_mode.py       # æ€§èƒ½æµ‹è¯•è„šæœ¬
â”œâ”€â”€ ğŸ“„ test_optimized_parser.py # ä¼˜åŒ–éªŒè¯è„šæœ¬
â”œâ”€â”€ ğŸ“„ README.md                # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ğŸ“„ ä¼˜åŒ–è¯´æ˜.md              # ä»£ç ä¼˜åŒ–æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ é€Ÿåº¦ä¼˜åŒ–è¯´æ˜.md          # æ€§èƒ½ä¼˜åŒ–æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ é¡¹ç›®ç»“æ„è¯´æ˜.md          # æœ¬æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ organize_project.py      # é¡¹ç›®æ•´ç†è„šæœ¬
â”œâ”€â”€ ğŸ“„ docx_parser.log          # è¿è¡Œæ—¥å¿—
â”‚
â”œâ”€â”€ ğŸ“ Files/                   # åŸå§‹æ–‡æ¡£å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ PLM2.0/             # PLM 2.0 ç›¸å…³æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BOM å®¡æ ¸ç”³è¯·.docx
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ CBBæ–°å»ºç”³è¯·V2.0.docx
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ æ–°ECR.docx
â”‚   â”‚   â””â”€â”€ ...                # å…¶ä»–Wordæ–‡æ¡£
â”‚   â””â”€â”€ ğŸ“ å…¶ä»–é¡¹ç›®/           # å…¶ä»–é¡¹ç›®æ–‡æ¡£
â”‚
â”œâ”€â”€ ğŸ“ parsed_docs/            # è§£æç»“æœå­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ PLM2.0_parsed/     # PLM2.0æ–‡æ¡£è§£æç»“æœ
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ summary.json    # æ‰¹é‡å¤„ç†æ±‡æ€»ä¿¡æ¯
â”‚   â”‚   â”œâ”€â”€ ğŸ“ BOMå®¡æ ¸ç”³è¯·/     # å•ä¸ªæ–‡æ¡£è§£æç»“æœ
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ document.json      # ç»“æ„åŒ–æ–‡æ¡£æ•°æ®
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ images/            # æå–çš„å›¾ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ smartart/          # SmartArtæ•°æ®
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ embedded_objects/  # åµŒå…¥å¯¹è±¡
â”‚   â”‚   â””â”€â”€ ğŸ“ å…¶ä»–æ–‡æ¡£/
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ single_files/      # å•ä¸ªæ–‡ä»¶è§£æç»“æœ
â”‚       â””â”€â”€ ğŸ“ æ–‡æ¡£å/
â”‚           â”œâ”€â”€ ğŸ“„ document.json
â”‚           â”œâ”€â”€ ğŸ“ images/
â”‚           â”œâ”€â”€ ğŸ“ smartart/
â”‚           â””â”€â”€ ğŸ“ embedded_objects/
â”‚
â”œâ”€â”€ ğŸ“ Test/                   # æµ‹è¯•å’Œå¼€å‘å·¥å…·
â”‚   â”œâ”€â”€ ğŸ“„ analyze_*.py       # å„ç§åˆ†æè„šæœ¬
â”‚   â”œâ”€â”€ ğŸ“„ test_*.py          # æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ ğŸ“„ SmartArtè§£ææ€»ç»“æŠ¥å‘Š.md
â”‚
â””â”€â”€ ğŸ“ __pycache__/           # Pythonç¼“å­˜æ–‡ä»¶
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. æ‰¹é‡å¤„ç†æ–‡ä»¶å¤¹
```bash
# å¤„ç†æ•´ä¸ªPLM2.0æ–‡ä»¶å¤¹
python docx_parser.py Files/PLM2.0

# ç»“æœå°†ä¿å­˜åœ¨ parsed_docs/PLM2.0_parsed/ ç›®å½•ä¸‹
```

### 2. å¤„ç†å•ä¸ªæ–‡ä»¶
```bash
# å¤„ç†å•ä¸ªDOCXæ–‡ä»¶
python docx_parser.py Files/PLM2.0/BOMå®¡æ ¸ç”³è¯·.docx

# ç»“æœå°†ä¿å­˜åœ¨ parsed_docs/single_files/BOMå®¡æ ¸ç”³è¯·/ ç›®å½•ä¸‹
```

### 3. å¿«é€Ÿæµ‹è¯•
```bash
# è¿è¡Œå¿«é€Ÿè§£æç¤ºä¾‹
python quick_parse_example.py

# è¿è¡Œæ€§èƒ½æµ‹è¯•
python test_quick_mode.py
```

## ğŸ“Š è§£æç»“æœç»“æ„

### document.json ç»“æ„
```json
{
  "metadata": {
    "source_path": "åŸå§‹æ–‡ä»¶è·¯å¾„",
    "title": "æ–‡æ¡£æ ‡é¢˜",
    "author": "ä½œè€…",
    "created": "åˆ›å»ºæ—¶é—´",
    "modified": "ä¿®æ”¹æ—¶é—´",
    "file_size": "æ–‡ä»¶å¤§å°"
  },
  "sections": [
    {
      "type": "section",
      "title": "ç« èŠ‚æ ‡é¢˜",
      "level": 1,
      "content": [
        {
          "type": "paragraph",
          "text": "æ®µè½å†…å®¹"
        },
        {
          "type": "list_item",
          "text": "åˆ—è¡¨é¡¹å†…å®¹",
          "prefix": "1. ",
          "level": 0
        },
        {
          "type": "image",
          "url": "images/img_xxx.jpg",
          "width": 800,
          "height": 600
        },
        {
          "type": "smartart",
          "text_content": ["èŠ‚ç‚¹1", "èŠ‚ç‚¹2"],
          "diagram_type": "process"
        },
        {
          "type": "embedded_object",
          "object_type": "visio_diagram",
          "description": "Visioç»˜å›¾/æµç¨‹å›¾"
        }
      ]
    }
  ],
  "images": {
    "img_xxx": {
      "type": "image",
      "url": "images/img_xxx.jpg",
      "format": "jpg",
      "width": 800,
      "height": 600,
      "size": "125.3 KB"
    }
  },
  "processing_info": {
    "timestamp": "å¤„ç†æ—¶é—´",
    "blocks_processed": 150,
    "images_found": 16,
    "errors": [],
    "warnings": []
  }
}
```

## ğŸ”§ ç›®å½•ç®¡ç†

### è‡ªåŠ¨ç›®å½•åˆ›å»º
- ç¨‹åºä¼šè‡ªåŠ¨åˆ›å»ºå¿…è¦çš„è¾“å‡ºç›®å½•
- è¾“å‡ºç›®å½•åŸºäºè¾“å…¥æ–‡ä»¶/æ–‡ä»¶å¤¹åç§°ç”Ÿæˆ
- é¿å…è¦†ç›–å·²æœ‰ç»“æœ

### ç›®å½•å‘½åè§„åˆ™
- **æ‰¹é‡å¤„ç†**: `parsed_docs/{æ–‡ä»¶å¤¹å}_parsed/`
- **å•æ–‡ä»¶å¤„ç†**: `parsed_docs/single_files/{æ–‡ä»¶å}/`
- **å®‰å…¨æ–‡ä»¶å**: è‡ªåŠ¨ç§»é™¤ç‰¹æ®Šå­—ç¬¦ï¼Œé™åˆ¶é•¿åº¦

### å†…å®¹åˆ†ç±»å­˜å‚¨
- **document.json**: ä¸»è¦çš„ç»“æ„åŒ–æ•°æ®
- **images/**: æ‰€æœ‰æå–çš„å›¾ç‰‡æ–‡ä»¶
- **smartart/**: SmartArtå›¾è¡¨çš„JSONæ•°æ®
- **embedded_objects/**: åµŒå…¥å¯¹è±¡çš„JSONæ•°æ®å’Œé¢„è§ˆå›¾

## ğŸ“ˆ å¤„ç†ç»Ÿè®¡

### summary.jsonï¼ˆæ‰¹é‡å¤„ç†æ—¶ç”Ÿæˆï¼‰
```json
{
  "input_folder": "Files/PLM2.0",
  "processing_timestamp": "2025-08-07 15:30:00",
  "total_files": 45,
  "processed": 42,
  "failed": 3,
  "success_rate": "93.3%",
  "documents": [
    {
      "file": "BOMå®¡æ ¸ç”³è¯·.docx",
      "status": "success",
      "images_found": 16,
      "warnings": 0,
      "errors": 0
    }
  ],
  "failed_files": []
}
```

## ğŸ› ï¸ ç»´æŠ¤å»ºè®®

### 1. å®šæœŸæ¸…ç†
- åˆ é™¤ä¸éœ€è¦çš„è§£æç»“æœ
- æ¸…ç†ä¸´æ—¶æ–‡ä»¶å’Œæ—¥å¿—

### 2. å¤‡ä»½é‡è¦ç»“æœ
- é‡è¦çš„è§£æç»“æœåº”è¯¥å¤‡ä»½
- è€ƒè™‘ç‰ˆæœ¬ç®¡ç†

### 3. ç›‘æ§ç©ºé—´ä½¿ç”¨
- å›¾ç‰‡æ–‡ä»¶å¯èƒ½å ç”¨è¾ƒå¤§ç©ºé—´
- å®šæœŸæ£€æŸ¥ç£ç›˜ä½¿ç”¨æƒ…å†µ

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **è¾“å…¥ç›®å½•**: è¯·å°†Wordæ–‡æ¡£æ”¾åœ¨ `Files/` ç›®å½•ä¸‹
2. **è¾“å‡ºç›®å½•**: è§£æç»“æœç»Ÿä¸€ä¿å­˜åœ¨ `parsed_docs/` ç›®å½•ä¸‹
3. **æ—¥å¿—æ–‡ä»¶**: è¿è¡Œæ—¥å¿—ä¿å­˜ä¸º `docx_parser.log`
4. **å¿«é€Ÿæ¨¡å¼**: é»˜è®¤å¯ç”¨ï¼Œè·³è¿‡è€—æ—¶çš„å›¾åƒè½¬æ¢
5. **é”™è¯¯å¤„ç†**: å¤„ç†å¤±è´¥çš„æ–‡ä»¶ä¼šåœ¨summary.jsonä¸­è®°å½•

## ğŸ“ æ”¯æŒä¿¡æ¯

- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶äº†è§£è¯¦ç»†çš„å¤„ç†è¿‡ç¨‹
- ä½¿ç”¨æµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½
- å‚è€ƒä¼˜åŒ–è¯´æ˜æ–‡æ¡£äº†è§£æ€§èƒ½æ”¹è¿›
