# DOCX è§£æå™¨ä¼˜åŒ–è¯´æ˜

## ğŸ¯ ä¸»è¦ä¼˜åŒ–å†…å®¹

### 1. **List Item å¤„ç†ä¼˜åŒ–**

**é—®é¢˜**: åŸä»£ç åœ¨åˆ—è¡¨é¡¹çš„æ–‡æœ¬å‰é¢é”™è¯¯åœ°æ·»åŠ äº†å‰ç¼€åºå·

**è§£å†³æ–¹æ¡ˆ**:
- å°†åŸå§‹æ–‡æœ¬å’Œå‰ç¼€åˆ†åˆ«å­˜å‚¨
- `text` å­—æ®µä¿å­˜åŸå§‹å†…å®¹ï¼Œä¸æ·»åŠ åºå·
- `prefix` å­—æ®µå•ç‹¬å­˜å‚¨åºå·/é¡¹ç›®ç¬¦å·
- `level` å­—æ®µå­˜å‚¨ç¼©è¿›å±‚çº§
- `is_bullet` å­—æ®µæ ‡è¯†æ˜¯å¦ä¸ºé¡¹ç›®ç¬¦å·

**ä¼˜åŒ–åçš„æ•°æ®ç»“æ„**:
```json
{
  "type": "list_item",
  "text": "åŸå§‹æ–‡æœ¬å†…å®¹",
  "level": 0,
  "prefix": "1. ",
  "is_bullet": false
}
```

### 2. **SmartArt è§£æå¢å¼º**

**åŠŸèƒ½**:
- âœ… è‡ªåŠ¨æ£€æµ‹ SmartArt å›¾è¡¨
- âœ… æå–å®Œæ•´çš„æ–‡æœ¬å†…å®¹
- âœ… ä¿æŒå±‚æ¬¡ç»“æ„
- âœ… è¯†åˆ«å›¾è¡¨ç±»å‹ (list, process, cycle, hierarchy, etc.)
- âœ… ç”Ÿæˆç‹¬ç«‹çš„ JSON æ–‡ä»¶å­˜å‚¨è¯¦ç»†ä¿¡æ¯

**ç‰¹æ€§**:
- å®Œæ•´çš„å‘½åç©ºé—´å¤„ç†
- å±‚æ¬¡ç»“æ„è§£æ
- å›é€€æœºåˆ¶ç¡®ä¿æ–‡æœ¬æå–
- ä¸Šä¸‹æ–‡ä½ç½®ä¿¡æ¯

### 3. **åµŒå…¥å¯¹è±¡å¤„ç†ä¼˜åŒ–**

**æ”¯æŒçš„å¯¹è±¡ç±»å‹**:
- ğŸ¨ Visio ç»˜å›¾/æµç¨‹å›¾
- ğŸ“Š Excel ç”µå­è¡¨æ ¼  
- ğŸ“º PowerPoint æ¼”ç¤ºæ–‡ç¨¿
- ğŸ“„ Word æ–‡æ¡£

**åŠŸèƒ½**:
- âœ… è‡ªåŠ¨è¯†åˆ«å¯¹è±¡ç±»å‹
- âœ… æå–å°ºå¯¸ä¿¡æ¯
- âœ… ä¿å­˜é¢„è§ˆå›¾åƒ
- âœ… è·å–åµŒå…¥æ–‡ä»¶å¤§å°
- âœ… EMF/WMF æ ¼å¼è‡ªåŠ¨è½¬æ¢

### 4. **å›¾åƒå¤„ç†å¢å¼º**

**EMF/WMF è½¬æ¢**:
- ğŸ”„ PIL è½¬æ¢ (ç¬¬ä¸€é€‰æ‹©)
- ğŸ”„ sips å‘½ä»¤ (macOS)
- ğŸ”„ qlmanage å‘½ä»¤ (macOS)
- ğŸ“ å¤±è´¥æ—¶ä¿å­˜åŸæ ¼å¼å¹¶æä¾›è½¬æ¢æŒ‡å—

**å›¾åƒæ ¼å¼æ”¯æŒ**:
- PNG, JPEG, GIF, BMP, SVG, TIFF
- EMF, WMF (è‡ªåŠ¨è½¬æ¢)

### 5. **ä»£ç ç»“æ„ä¼˜åŒ–**

**æ¶ˆé™¤çš„å†—ä½™**:
- âœ… åˆå¹¶é‡å¤çš„å›¾ç‰‡æå–å‡½æ•°
- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†é€»è¾‘
- âœ… ç®€åŒ–é‡å¤çš„æ¡ä»¶åˆ¤æ–­
- âœ… ç§»é™¤æœªä½¿ç”¨çš„å¯¼å…¥
- âœ… ä¼˜åŒ–å˜é‡å‘½åå’Œä½œç”¨åŸŸ

**æ–°å¢è¾…åŠ©å‡½æ•°**:
- `add_error_to_failed_files()` - ç»Ÿä¸€é”™è¯¯è®°å½•
- `safe_filename()` - å®‰å…¨æ–‡ä»¶åç”Ÿæˆ

## ğŸ“Š è¾“å‡ºç»“æ„

### å®Œæ•´çš„æ–‡æ¡£ç»“æ„
```json
{
  "metadata": {
    "source_path": "æ–‡ä»¶è·¯å¾„",
    "title": "æ–‡æ¡£æ ‡é¢˜",
    "author": "ä½œè€…",
    "file_size": "æ–‡ä»¶å¤§å°"
  },
  "sections": [
    {
      "type": "section",
      "title": "ç« èŠ‚æ ‡é¢˜",
      "level": 1,
      "content": [
        {
          "type": "paragraph",
          "text": "æ®µè½å†…å®¹",
          "bold": false,
          "italic": false
        },
        {
          "type": "list_item",
          "text": "åˆ—è¡¨é¡¹å†…å®¹",
          "level": 0,
          "prefix": "1. ",
          "is_bullet": false
        },
        {
          "type": "smartart",
          "diagram_type": "process",
          "text_content": [...]
        },
        {
          "type": "embedded_object",
          "object_type": "visio_diagram",
          "description": "Visioç»˜å›¾/æµç¨‹å›¾",
          "preview_image": "images/preview.png"
        },
        {
          "type": "image",
          "url": "images/img_123.png",
          "width": 800,
          "height": 600
        }
      ]
    }
  ],
  "images": {
    "img_123": {
      "type": "image",
      "url": "images/img_123.png",
      "format": "png",
      "size": "150.25 KB"
    }
  },
  "processing_info": {
    "timestamp": "2025-08-07 10:30:00",
    "blocks_processed": 150,
    "images_found": 5,
    "warnings": [],
    "errors": []
  }
}
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å•ä¸ªæ–‡ä»¶å¤„ç†
```python
from docx_parser import parse_docx

result = parse_docx("document.docx", "output_dir")
if result:
    print(f"æˆåŠŸè§£æï¼Œæ‰¾åˆ° {len(result['images'])} å¼ å›¾ç‰‡")
```

### æ‰¹é‡å¤„ç†
```python
from docx_parser import process_docx_folder

count = process_docx_folder("input_folder", "output_folder")
print(f"æˆåŠŸå¤„ç† {count} ä¸ªæ–‡ä»¶")
```

### å‘½ä»¤è¡Œä½¿ç”¨
```bash
# å¤„ç†å•ä¸ªæ–‡ä»¶
python docx_parser.py document.docx

# æ‰¹é‡å¤„ç†æ–‡ä»¶å¤¹
python docx_parser.py Documents/
```

## ğŸ“ è¾“å‡ºæ–‡ä»¶ç»“æ„
```
output_dir/
â”œâ”€â”€ document.json          # ä¸»è¦è§£æç»“æœ
â”œâ”€â”€ images/                # æå–çš„å›¾ç‰‡
â”‚   â”œâ”€â”€ img_abc123.png
â”‚   â””â”€â”€ embedded_preview_def456.png
â”œâ”€â”€ smartart/              # SmartArt è¯¦ç»†æ•°æ®
â”‚   â””â”€â”€ smartart_789.json
â””â”€â”€ embedded_objects/      # åµŒå…¥å¯¹è±¡ä¿¡æ¯
    â””â”€â”€ embedded_obj_xyz.json
```

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›

1. **å‡†ç¡®æ€§**: List Item ä¸å†æœ‰é”™è¯¯çš„åºå·å‰ç¼€
2. **å®Œæ•´æ€§**: SmartArt å’ŒåµŒå…¥å¯¹è±¡å®Œæ•´æå–
3. **å¥å£®æ€§**: å¢å¼ºçš„é”™è¯¯å¤„ç†å’Œå›é€€æœºåˆ¶
4. **å¯ç»´æŠ¤æ€§**: æ¶ˆé™¤ä»£ç å†—ä½™ï¼Œæé«˜å¯è¯»æ€§
5. **æ‰©å±•æ€§**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ·»åŠ æ–°åŠŸèƒ½

## âœ… éªŒè¯æ–¹æ³•

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯ä¼˜åŒ–æ•ˆæœï¼š
```bash
python test_optimized_parser.py
```

è¿™å°†æµ‹è¯•æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å¹¶ç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šã€‚
