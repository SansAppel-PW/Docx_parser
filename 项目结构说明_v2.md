# DOCXè§£æå™¨é¡¹ç›®ç»“æ„è¯´æ˜ v2.0 - æ¨¡å—åŒ–ç‰ˆæœ¬

## ğŸ“ é¡¹ç›®æ€»è§ˆ

```
Docx_parser-main/
â”œâ”€â”€ Files/                           # ğŸ“‚ åŸå§‹æ–‡æ¡£å­˜å‚¨
â”‚   â”œâ”€â”€ PLM2.0/                     # PLMä¸šåŠ¡æµç¨‹æ–‡æ¡£
â”‚   â””â”€â”€ examples/                   # ç¤ºä¾‹æ–‡æ¡£
â”‚
â”œâ”€â”€ parsed_docs/                    # ğŸ“„ è§£æç»“æœè¾“å‡º
â”‚   â”œâ”€â”€ PLM2.0_parsed/             # æ‰¹é‡å¤„ç†ç»“æœ
â”‚   â””â”€â”€ single_files/              # å•æ–‡ä»¶å¤„ç†ç»“æœ
â”‚
â”œâ”€â”€ src/                            # ğŸ§© æ¨¡å—åŒ–æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ parsers/                   # è§£æå™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ document_parser.py     # æ ¸å¿ƒæ–‡æ¡£è§£æå™¨
â”‚   â”‚   â”œâ”€â”€ table_parser.py        # è¡¨æ ¼è§£æå™¨
â”‚   â”‚   â””â”€â”€ batch_processor.py     # æ‰¹é‡å¤„ç†å™¨
â”‚   â”œâ”€â”€ extractors/                # æå–å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ image_extractor.py     # å›¾åƒæå–å™¨
â”‚   â”‚   â”œâ”€â”€ smartart_extractor.py  # SmartArtæå–å™¨
â”‚   â”‚   â””â”€â”€ content_extractor.py   # å†…å®¹æå–å™¨
â”‚   â””â”€â”€ utils/                     # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ text_utils.py          # æ–‡æœ¬å¤„ç†å·¥å…·
â”‚       â”œâ”€â”€ document_utils.py      # æ–‡æ¡£ç»“æ„å·¥å…·
â”‚       â””â”€â”€ image_utils.py         # å›¾åƒå¤„ç†å·¥å…·
â”‚
â”œâ”€â”€ Test/                           # ğŸ§ª æµ‹è¯•å’Œå¼€å‘å·¥å…·
â”‚   â”œâ”€â”€ test_modular_parser.py     # æ¨¡å—åŒ–è§£æå™¨æµ‹è¯•
â”‚   â”œâ”€â”€ quick_parse_example.py     # å¿«é€Ÿè§£æç¤ºä¾‹
â”‚   â”œâ”€â”€ test_optimized_parser.py   # ä¼˜åŒ–æµ‹è¯•
â”‚   â””â”€â”€ (å…¶ä»–æµ‹è¯•æ–‡ä»¶...)
â”‚
â”œâ”€â”€ backups/                        # ğŸ—„ï¸ å†å²æ•°æ®å¤‡ä»½
â”‚
â”œâ”€â”€ docx_parser_modular.py          # ğŸš€ æ¨¡å—åŒ–ä¸»ç¨‹åº
â”œâ”€â”€ docx_parser.py                  # ğŸ“œ åŸå§‹å•ä½“ç¨‹åº(ä¿ç•™)
â”œâ”€â”€ organize_project.py             # ğŸ”§ é¡¹ç›®æ•´ç†å·¥å…·
â”œâ”€â”€ README.md                       # ğŸ“– é¡¹ç›®è¯´æ˜
â”œâ”€â”€ é¡¹ç›®ç»“æ„è¯´æ˜.md                   # ğŸ“‹ æ—§ç‰ˆæ–‡æ¡£(ä¿ç•™)
â”œâ”€â”€ é¡¹ç›®ç»“æ„è¯´æ˜_v2.md               # ğŸ“‹ æœ¬æ–‡æ¡£
â”œâ”€â”€ é€Ÿåº¦ä¼˜åŒ–è¯´æ˜.md                   # ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–è¯´æ˜
â””â”€â”€ é¡¹ç›®æ•´ç†å®ŒæˆæŠ¥å‘Š.md               # ğŸ“Š é¡¹ç›®æŠ¥å‘Š
```

## ğŸš€ æ¨¡å—åŒ–æ¶æ„ä¼˜åŠ¿

### 1. ä»£ç ç»„ç»‡æ¸…æ™°
- **src/parsers/**: æ ¸å¿ƒè§£æé€»è¾‘
- **src/extractors/**: å†…å®¹æå–é€»è¾‘  
- **src/utils/**: é€šç”¨å·¥å…·å‡½æ•°
- **Test/**: æµ‹è¯•è„šæœ¬ç‹¬ç«‹ç®¡ç†

### 2. æ¨¡å—èŒè´£åˆ†ç¦»

#### è§£æå™¨æ¨¡å— (src/parsers/)
- **document_parser.py**: æ–‡æ¡£è§£æä¸»æµç¨‹ï¼Œå¤„ç†æ®µè½ã€æ ‡é¢˜ã€åˆ—è¡¨
- **table_parser.py**: ä¸“é—¨å¤„ç†è¡¨æ ¼è§£æå’Œåˆå¹¶å•å…ƒæ ¼
- **batch_processor.py**: æ‰¹é‡å¤„ç†é€»è¾‘å’Œè¿›åº¦è·Ÿè¸ª

#### æå–å™¨æ¨¡å— (src/extractors/)
- **image_extractor.py**: å›¾åƒæå–å’Œä¿å­˜
- **smartart_extractor.py**: SmartArtå’ŒåµŒå…¥å¯¹è±¡æå–
- **content_extractor.py**: æ®µè½å†…å®¹ç»Ÿä¸€æå–å…¥å£

#### å·¥å…·æ¨¡å— (src/utils/)
- **text_utils.py**: æ–‡æœ¬æ¸…ç†ã€æ ‡é¢˜è¯†åˆ«ã€åˆ—è¡¨å¤„ç†
- **document_utils.py**: æ–‡æ¡£éå†ã€è¡¨æ ¼åˆ†æ
- **image_utils.py**: å›¾åƒè½¬æ¢ã€å°ºå¯¸è·å–

### 3. ä»£ç é‡ç”¨å’Œç»´æŠ¤æ€§
- æ¨¡å—åŒ–è®¾è®¡ä¾¿äºå•ç‹¬æµ‹è¯•å’Œè°ƒè¯•
- åŠŸèƒ½è§£è€¦ï¼Œé™ä½ä»£ç å¤æ‚åº¦
- æ˜“äºæ‰©å±•æ–°åŠŸèƒ½å’Œæ ¼å¼æ”¯æŒ

## ğŸ¯ ä½¿ç”¨æŒ‡å—

### ä¸»ç¨‹åºï¼ˆæ¨èä½¿ç”¨æ¨¡å—åŒ–ç‰ˆæœ¬ï¼‰
```bash
# ä½¿ç”¨æ–°çš„æ¨¡å—åŒ–ç‰ˆæœ¬
python docx_parser_modular.py Files/PLM2.0
python docx_parser_modular.py "Files/PLM2.0/BOM å®¡æ ¸ç”³è¯·.docx"

# åŸå§‹ç‰ˆæœ¬ï¼ˆä¿ç•™å…¼å®¹æ€§ï¼‰
python docx_parser.py Files/PLM2.0
```

### æµ‹è¯•è„šæœ¬
```bash
cd Test
python test_modular_parser.py      # æµ‹è¯•æ¨¡å—åŒ–è§£æå™¨
python quick_parse_example.py      # å¿«é€Ÿè§£æç¤ºä¾‹
```

### é¡¹ç›®ç»´æŠ¤
```bash
python organize_project.py         # é¡¹ç›®ç»“æ„æ•´ç†
```

## ğŸ”§ æ¨¡å—è¯¦ç»†è¯´æ˜

### æ ¸å¿ƒè§£æå™¨ (src/parsers/document_parser.py)
```python
# ä¸»è¦åŠŸèƒ½
- parse_docx(docx_path, output_dir, quick_mode=True)
- extract_metadata(doc, docx_path)
- æ–‡æ¡£ç»“æ„è§£æå’Œå†…å®¹æå–
```

### æ‰¹é‡å¤„ç†å™¨ (src/parsers/batch_processor.py)
```python
# ä¸»è¦åŠŸèƒ½
- process_docx_folder(input_folder, output_base_dir, quick_mode=True)
- è¿›åº¦è·Ÿè¸ªå’Œé”™è¯¯å¤„ç†
- ç”Ÿæˆå¤„ç†æ±‡æ€»æŠ¥å‘Š
```

### å†…å®¹æå–å™¨ (src/extractors/content_extractor.py)
```python
# ä¸»è¦åŠŸèƒ½
- extract_paragraph_content(para, output_dir, image_references, quick_mode=True)
- ç»Ÿä¸€çš„æ®µè½å†…å®¹æå–æ¥å£
- é›†æˆå›¾ç‰‡ã€SmartArtã€åµŒå…¥å¯¹è±¡æå–
```

### å›¾åƒå¤„ç† (src/utils/image_utils.py)
```python
# ä¸»è¦åŠŸèƒ½
- convert_emf_to_png(emf_data, output_dir, object_id, quick_mode=True)
- extract_preview_image(image_part, output_dir, object_id, quick_mode=True)
- get_image_dimensions(image_data)
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§

### å¿«é€Ÿæ¨¡å¼ (Quick Mode)
- é»˜è®¤å¯ç”¨ï¼Œè·³è¿‡è€—æ—¶çš„EMF/WMFè½¬æ¢
- ç›´æ¥ä¿å­˜åŸå§‹æ ¼å¼ï¼Œåç»­å¯æŒ‰éœ€è½¬æ¢
- å¤„ç†é€Ÿåº¦æå‡97%+

### æ¨¡å—åŒ–è®¾è®¡ä¼˜åŠ¿
- å‡å°‘ä»£ç é‡å¤ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡
- æŒ‰éœ€åŠ è½½æ¨¡å—ï¼Œé™ä½å†…å­˜å ç”¨
- å¹¶è¡Œå¤„ç†èƒ½åŠ›æ›´å¼º

### é”™è¯¯å¤„ç†å¥å£®æ€§
- å„æ¨¡å—ç‹¬ç«‹é”™è¯¯å¤„ç†
- å¤±è´¥æ–‡ä»¶ä¸å½±å“æ•´ä½“å¤„ç†
- è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šå’Œæ—¥å¿—

## ğŸ”„ ä»å•ä½“åˆ°æ¨¡å—åŒ–çš„è¿ç§»

### ä»£ç æ‹†åˆ†ç­–ç•¥
1. **æŒ‰åŠŸèƒ½æ¨¡å—æ‹†åˆ†**: è§£æã€æå–ã€å·¥å…·
2. **æŒ‰æ•°æ®ç±»å‹æ‹†åˆ†**: æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼ã€SmartArt
3. **æŒ‰å¤„ç†æµç¨‹æ‹†åˆ†**: å•æ–‡ä»¶ã€æ‰¹é‡å¤„ç†

### å…¼å®¹æ€§ä¿è¯
- ä¿ç•™åŸå§‹ `docx_parser.py` æ–‡ä»¶
- APIæ¥å£ä¿æŒä¸€è‡´
- è¾“å‡ºæ ¼å¼å®Œå…¨å…¼å®¹

### è¿ç§»å»ºè®®
- æ–°é¡¹ç›®ä½¿ç”¨ `docx_parser_modular.py`
- ç°æœ‰é¡¹ç›®å¯é€æ­¥è¿ç§»
- æµ‹è¯•éªŒè¯åŠŸèƒ½ä¸€è‡´æ€§

## ğŸ§ª æµ‹è¯•å’ŒéªŒè¯

### å•å…ƒæµ‹è¯•
```bash
cd Test
python test_modular_parser.py      # æ¨¡å—åŒ–åŠŸèƒ½æµ‹è¯•
```

### æ€§èƒ½æµ‹è¯•
```bash
cd Test  
python quick_parse_example.py      # å¿«é€Ÿè§£ææµ‹è¯•
```

### å…¼å®¹æ€§æµ‹è¯•
```bash
# å¯¹æ¯”æ–°æ—§ç‰ˆæœ¬è¾“å‡º
python docx_parser.py Files/PLM2.0
python docx_parser_modular.py Files/PLM2.0
```

## ğŸ“ˆ åç»­å‘å±•è§„åˆ’

### è¿‘æœŸç›®æ ‡
- [ ] å®Œå–„æ¨¡å—å•å…ƒæµ‹è¯•
- [ ] æ·»åŠ é…ç½®æ–‡ä»¶æ”¯æŒ
- [ ] æä¾›æ›´å¤šè¾“å‡ºæ ¼å¼é€‰é¡¹

### é•¿æœŸç›®æ ‡
- [ ] æ”¯æŒæ›´å¤šOfficeæ ¼å¼
- [ ] é›†æˆWebæœåŠ¡æ¥å£
- [ ] æ·»åŠ GUIç•Œé¢

---

**ç‰ˆæœ¬**: 2.0.0 (æ¨¡å—åŒ–ç‰ˆæœ¬)  
**æ›´æ–°æ—¥æœŸ**: 2025-08-07  
**ç»´æŠ¤çŠ¶æ€**: âš¡ ç§¯æå¼€å‘ä¸­
